<!DOCTYPE html>
<html>
  <head>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
      crossorigin="anonymous"
    />
    <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"
      integrity="sha512-T/tUfKSV1bihCnd+MxKD0Hm1uBBroVYBOYSk1knyvQ9VyZJpc/ALb4P0r6ubwVPSGB2GvjeoMAJJImBG12TiaQ=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css"
      integrity="sha512-mSYUmp1HYZDFaVKK//63EcZq4iFWFjxSL+Z3T/aCt4IO9Cejm03q3NKKYN6pFQzY0SBOr8h+eCIAZHPXcpZaNw=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/locales/bootstrap-datepicker.ko.min.js"
      integrity="sha512-L4qpL1ZotXZLLe8Oo0ZyHrj/SweV7CieswUODAAPN/tnqN3PA1P+4qPu5vIryNor6HQ5o22NujIcAZIfyVXwbQ=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <link rel="stylesheet" href="/stylesheets/style.css" />
  </head>
<body>
<section>
    <div class="container" style="text-align: center">
      <h1>한국 경제 검색</h1>
      <form action="/search" method="post">
        <input
          placeholder="검색어를 입력해주세요"
          name="word"
          id="word"
          style="
            width: 300px;
            height: 42px;
            margin-top: 20px;
            border-radius: 3px;
            box-sizing: border-box;
          "
          value="<%=q%>"
        />
        <button class="btn btn-primary" type="submit" value="검색">
          검색
        </button>
        <button
          class="btn btn-outline-primary"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#detailsearch"
          aria-expanded="false"
          aria-controls="detailsearch"
        >
          상세검색
        </button>
        <div class="collapse" id="detailsearch" style="text-align: center;margin-left: 100px;">
          <div
            class="card card-body"
            style="
              margin-top: 30px;
              width: 400px;
              margin-left: 400px;
              text-align: center;
            "
          >
            <h6>기간별 조회</h6>
            <div style="text-align: center; margin: auto">
              <input

                id="date-picker"
                name="startdate"
                class="form-control bg-white border-2 small"
                aria-label="Search"
                aria-describedby="basic-addon2"
                th:value="|${year}-${month}|"
                style="width: 100px"
                placeholder="시작일"
              />
              <input
                id="date-picker2"
                name="findate"
                class="form-control bg-white border-2 small"
                aria-label="Search"
                aria-describedby="basic-addon2"
                th:value="|${year}-${month}|"
                style="width: 100px"
                placeholder="종료일"
              />
              <span id="dateappend"> </span>
            </div>
          </div>
        </div>
      </form>
    </div>
  </section>
  <hr>
  <div class="container">
    <% for(var i=0; i<data.length; i++){ %>

    <div><%=i+1%> 번기사</div>
    <hr>
    <h3>타이틀 : <%=data[i]._source.title%></h3>
    <h6>기자 : <%=data[i]._source.reporter%></h6>
    <div>내용 : <%=data[i]._source.content%></div>
    <div>날짜 : <%=data[i]._source.start_dttm%> </div>
    <br>
    <%}%> 
      </div>

      <div>
        <!-- <% let pageInfo=0 %> -->
        <a
          href="http://localhost:3000/search?pageInfo=<%=pageInfo-1%>&q=<%=q%>"
        >
          [<<]
        </a>
        <% if(pageInfo==1){%> <%}else{%>
        <a
          href="http://localhost:3000/search?pageInfo=<%=pageInfo-1%>&q=<%=q%>"
        >
          [<]
        </a>
        <%}%> 
        <% let v = totaldata.hits.total.value/10%> 
        <% let v2 =totaldata.hits.total.value%10%> 
        <% for(var i=0; i < v; i++){%>
        <a
          href="http://localhost:3000/search?pageInfo=<%= i+1 %>&q=<%=q%>"
          ><%= i+1 %></a
        >
        <%}%> <% let v1 = Math.floor(v)%> 
        <% if(pageInfo==v1*10-10 && v2==0){%>
        <%}else if(pageInfo==v1*10 && v2!==0){ %> 
          <%}else{%>
        <a
          href="http://localhost:3000/search?pageInfo=<%=Number(pageInfo)+Number(1)%>&q=<%=q%>"
        >
          [>]
        </a>
        <%}%>
        <a
          href="http://localhost:3000/search?pageInfo=<%=pageInfo-1%>&q=<%=q%>"
        >
          [>>]
        </a>
      </div>

      <script>
        $(document).ready(function () {
          $("#date-picker").datepicker({
            format: "yyyy-mm",
            minViewMode: 1,
            language: "ko",
            autoclose: true,
          });
          $("#get-history").on("click", function () {
            const dateArr = $("#date-picker").val().split("-");
            location.href =
              "/history?year=" + dateArr[0] + "&month=" + dateArr[1];
          });
        });
      </script>
      <script>
        $(document).ready(function () {
          $("#date-picker2").datepicker({
            format: "yyyy-mm",
            minViewMode: 1,
            language: "ko",
            autoclose: true,
          });
          $("#get-history").on("click", function () {
            const dateArr = $("#date-picker").val().split("-");
            location.href =
              "/history?year=" + dateArr[0] + "&month=" + dateArr[1];
          });
        });
      </script>
      <script
        src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
        crossorigin="anonymous"
      ></script>
</body>
</html>
